<!DOCTYPE html><html lang="en" class="app" xmlns:th="http://www.thymeleaf.org"><head>    <meta charset="utf-8"/>    <title>ME+企业用户管理</title>    <meta name="description"          content="app, web app, responsive, admin dashboard, admin, flat, flat ui, ui kit, off screen nav"/>    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>    <link rel="stylesheet" href="/css/bootstrap.css" type="text/css"/>    <link rel="stylesheet" href="/css/animate.css" type="text/css"/>    <link rel="stylesheet" href="/css/font-awesome.min.css" type="text/css"/>    <link rel="stylesheet" href="/css/simple-line-icons.css" type="text/css"/>    <link rel="stylesheet" href="/css/font.css" type="text/css"/>    <link rel="stylesheet" href="/css/app.css" type="text/css"/>    <link rel="stylesheet" type="text/css" href="/css/zeroModal.css"/>    <link href="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.4/summernote.css" rel="stylesheet">    <!--<link href="/css/foundation.min.css" rel="stylesheet" type="text/css">-->    <!--[if lt IE 9]>    <script src="js/ie/html5shiv.js"></script>    <script src="js/ie/respond.min.js"></script>    <script src="js/ie/excanvas.js"></script>    <![endif]--></head><body class=""><section class="vbox">    <header class="bg-white-only header header-md navbar navbar-fixed-top-xs">        <div class="navbar-header aside bg-info dk" style="background:#21aa93">            <a class="btn btn-link visible-xs" data-toggle="class:nav-off-screen,open" data-target="#nav,html">                <i class="icon-list"></i>            </a>            <a href="javascript:void(0)" class="navbar-brand text-lt">                <img src="http://m.mjiahome.com/img/cmslogo.jpg"                     style="width: 40px;height: 40px;vertical-align:middle;">                <small>公寓新媒体平台</small>            </a>            <a class="btn btn-link visible-xs" data-toggle="dropdown" data-target=".user">                <i class="icon-settings"></i>            </a>        </div>        <ul class="nav navbar-nav hidden-xs">            <li>                <a href="#nav,.navbar-header" data-toggle="class:nav-xs,nav-xs" class="text-muted">                    <i class="fa fa-indent text"></i>                    <i class="fa fa-dedent text-active"></i>                </a>            </li>        </ul>        <form class="navbar-form navbar-left input-s-lg m-t m-l-n-xs hidden-xs" role="search">            <div class="form-group" style="display: none">                <div class="input-group">            <span class="input-group-btn">              <button type="submit" class="btn btn-sm bg-white btn-icon rounded"><i class="fa fa-search"></i></button>            </span>                    <input type="text" class="form-control input-sm no-border rounded"                           placeholder="ME+搜索"/>                </div>            </div>        </form>        <div class="navbar-right ">            <ul class="nav navbar-nav m-n hidden-xs nav-user user">                <li class="hidden-xs" style="display: none">                    <a href="#" class="dropdown-toggle lt" data-toggle="dropdown">                        <i class="icon-bell"></i>                        <span class="badge badge-sm up bg-danger count">2</span>                    </a>                    <section class="dropdown-menu aside-xl animated fadeInUp">                        <section class="panel bg-white">                            <div class="panel-heading b-light bg-light">                                <strong>You have <span class="count">2</span> notifications</strong>                            </div>                            <div class="list-group list-group-alt">                                <a href="#" class="media list-group-item">                                    <span class="pull-left thumb-sm">                                      <img src="/images/a0.png" alt="..." class="img-circle"/>                                    </span>                                    <span class="media-body block m-b-none">                                      Use awesome animate.css<br/>                                      <small class="text-muted">10 minutes ago</small>                                    </span>                                </a>                                <a href="#" class="media list-group-item">                                <span class="media-body block m-b-none">                                  1.0 initial released<br/>                                  <small class="text-muted">1 hour ago</small>                                </span>                                </a>                            </div>                            <div class="panel-footer text-sm">                                <a href="#" class="pull-right"><i class="fa fa-cog"></i></a>                                <a href="#notes" data-toggle="class:show animated fadeInRight">See all the                                    notifications</a>                            </div>                        </section>                    </section>                </li>                <li class="dropdown">                    <a href="#" class="dropdown-toggle bg clear" data-toggle="dropdown">                      <span class="thumb-sm avatar pull-right m-t-n-sm m-b-n-sm m-l-sm">                        <img src="/images/a0.png" th:attr="src=${session.user.getAvatar()}" alt="..."/>                      </span>                        <span th:text="${session.user.getNickName()}"></span><b class="caret"></b>                    </a>                    <ul class="dropdown-menu animated fadeInRight">                        <li>                            <a href="/html/logout.html">Logout</a>                        </li>                    </ul>                </li>            </ul>        </div>    </header>    <section>        <section class="hbox stretch">            <aside class="bg-black dk aside hidden-print" id="nav">                <section class="vbox">                    <section class="w-f-md scrollable">                        <div class="slim-scroll" data-height="auto" data-disable-fade-out="true" data-distance="0"                             data-size="10px" data-railOpacity="0.2">                            <nav class="nav-primary hidden-xs">                                <ul class="nav" data-ride="collapse">                                    <li class="active">                                        <a href="#" class="auto"><span class="pull-right text-muted"><i                                                class="fa fa-angle-left text"></i><i                                                class="fa fa-angle-down text-active"></i></span><i                                                class="icon-grid icon"></i><span>平台后台1.0</span> </a>                                        <ul class="nav dk text-sm">                                            <li><a href="/html/platform/supplierList.html" class="auto"><i                                                    class="fa fa-angle-right text-xs"></i><span>供应商管理</span></a></li>                                            <li><a href="/html/platform/order.html" class="auto"><i                                                    class="fa fa-angle-right text-xs"></i><span>预约－租借管理</span></a></li>                                            <li><a href="/html/platform/product.html" class="auto"><i                                                    class="fa fa-angle-right text-xs"></i><span>产品资源管理</span></a></li>                                            <li><a href="/html/platform/users.html" class="auto"><i                                                    class="fa fa-angle-right text-xs"></i><span>用户资源管理</span></a></li>                                            <li><a href="/html/platform/companylist.html" class="auto"><i                                                    class="fa fa-angle-right text-xs"></i><span>合作企业</span></a></li>                                            <li><a href="/html/platform/activity.html" class="auto"><i                                                    class="fa fa-angle-right text-xs"></i><span>资讯管理</span></a></li>                                        </ul>                                    </li>                                </ul>                            </nav>                        </div>                    </section>                </section>            </aside>            <section id="content">                <section class="vbox">                    <section class="scrollable padder">                        <div class="m-b-md">                            <h3 class="m-b-none"></h3>                        </div>                        <section class="panel panel-default">                            <header class="panel-heading">                                <h4 class="font-bold">资讯管理</h4>                            </header>                            <div class="panel-body">                                <form class="form-horizontal">                                    <div class="form-group">                                        <label class="col-sm-2 control-label">标题</label>                                        <div class="col-sm-5">                                            <input type="text" class="form-control rounded" id="subject">                                        </div>                                    </div>                                    <div class="line line-dashed b-b line-lg pull-in"></div>                                    <div class="form-group">                                        <label class="col-sm-2 control-label">类型</label>                                        <div class="col-sm-5">                                            <div class="radio i-checks"><label><input type="radio" name="topicType"                                                                                      value="normal" checked><i></i>一般资讯</label>                                            </div>                                            <div class="radio i-checks"><label><input type="radio" name="topicType"                                                                                      value="activity"><i></i>活动</label>                                            </div>                                            <div class="radio i-checks"><label><input type="radio" name="topicType"                                                                                      value="topic"><i></i>专题</label>                                            </div>                                        </div>                                    </div>                                    <div class="line line-dashed b-b line-lg pull-in"></div>                                    <div class="form-group"><label class="col-sm-2 control-label">是否应用于首页banner</label>                                        <div class="col-sm-5">                                            <div class="radio i-checks"><label><input type="radio"                                                                                      name="displayLocation" value="0"                                                                                      checked><i></i>否</label></div>                                            <div class="radio i-checks"><label><input type="radio"                                                                                      name="displayLocation"                                                                                      value="index"><i></i>是</label>                                            </div>                                        </div>                                    </div>                                    <div class="line line-dashed b-b line-lg pull-in"></div>                                    <div class="form-group">                                        <label class="col-sm-2 control-label">内容</label>                                        <div class="col-sm-5">                                            <div id="summernote"><p>输入内容</p></div>                                        </div>                                    </div>                                    <div class="line line-dashed b-b line-lg pull-in"></div>                                    <div class="form-group">                                        <label class="col-sm-2 control-label">资讯图片</label>                                    </div>                                    <div id="productDetailPicDiv">                                    </div>                                    <div class="form-group">                                        <label class="col-sm-2 control-label"></label>                                        <div class="m-r col-sm-2">                                            <a class="btn btn-info" href="javascript:void(0)" id="newPic"><i                                                    class="fa fa-plus"></i>&nbsp;&nbsp;&nbsp;新增图片</a>                                        </div>                                    </div>                                    <div class="line line-dashed b-b line-lg pull-in"></div>                                    <div class="form-group">                                        <label class="col-sm-2 control-label">来源</label>                                        <div class="col-sm-5">                                            <input type="text" class="form-control rounded"                                                   id="contentFrom">                                        </div>                                    </div>                                    <div class="line line-dashed b-b line-lg pull-in"></div>                                    <div class="form-group">                                        <div class="col-sm-4 col-sm-offset-2">                                            <button type="button" class="btn btn-primary" id="btn_submit">                                                保存                                            </button>                                        </div>                                    </div>                                </form>                            </div>                        </section>                        <div class="m-b-md">                            <div class="text-center padder clearfix">                                <p>                                    <small>上海寓伽信息科技有限公司&nbsp;&copy;2017</small>                                </p>                            </div>                        </div>                    </section>                </section>                <a href="#" class="hide nav-off-screen-block" data-toggle="class:nav-off-screen,open"                   data-target="#nav,html"></a>            </section>        </section>    </section></section><script src="/js/jquery.min.js"></script><script type="text/javascript"        src="http://resource.mjiahome.com/mj/static/oss_js/lib/plupload-2.1.2/js/plupload.full.min.js"></script><script src="/js/uploadV2.js"></script><script src="/js/zeroModal.min.js"></script><script src="/js/area/charfirstPinyin.js"></script><script src="http://cdnjs.cloudflare.com/ajax/libs/summernote/0.8.4/summernote.js"></script><script type="application/javascript"  th:inline="javascript">    String.prototype.startWith = function (str) {        var reg = new RegExp("^" + str);        return reg.test(this);    };    function getRandomId(len) {        len = len || 32;        var chars = 'ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678';        var maxPos = chars.length;        var pwd = '';        for (i = 0; i < len; i++) {            pwd += chars.charAt(Math.floor(Math.random() * maxPos));        }        return (Date.parse(new Date()) / 1000) + pwd;    }    var tid = GetQueryParam('code');    var dataBuff = [];    var uid = [[${session.user.getAdminId()}]];    $(function () {    	console.log("code:"+tid);    	$('#summernote').summernote();        bindUpload({            "id": 'newPic',            finish: function (file) {                var newUploadId = getRandomId(10);                var picSizeNow = $("div[name='detail_pic_group']").size();                var txt = '<div class="form-group" name="detail_pic_group" id="' + newUploadId + '"><label class="col-sm-2 control-label"></label><div class="m-r col-sm-2">' +                    '<img src="' + file + '" name="ImgDetailPic" class="r r-2x" width="100%" height="100px" id="img' + newUploadId + '" ></div><div class="m-r col-sm-3">' +                    '<br><button class="btn btn-danger" onclick="removePic(\'' + newUploadId + '\')"><i class="fa fa-trash-o"></i>&nbsp;&nbsp;&nbsp;<span>删除图片</span></button>' +                    '<div class="radio i-checks"><label><input type="radio" name="detailpic" ' + (0 == picSizeNow ? "checked" : "") + ' value="' + newUploadId + '" ><i></i>设置为列表展示图</label></div></div></div>';                $('#productDetailPicDiv').append(txt);            }        });        var data = {};        data['tid']=tid;        if(tid!=null&&tid!=''&&tid!='undefined'){        $.ajax({            type: "POST",            async: true,            url: "/api/topic/list",            contentType: "application/json",            data: JSON.stringify(data),            dataType: "json",            success: function (ret) {                $.each(ret['result'], function (index, val) {                	$('#subject').val(val['subject']);                	$("input[name='topicType'][value='"+val['topicType']+"']").attr("checked",true);                    $("input[name='displayLocation'][value='"+val['displayLocation']+"']").attr("checked",true);                                        var markupStr = val['formatContent'];                    $('#summernote').summernote('code', markupStr);                    $('#contentFrom').val(val['contentFrom']);                    var detailPic = $('#productDetailPicDiv');                    var arr=val['listpic'];                    for (var index = 0; index < arr.length; index++) {                        var imgId = getRandomId(10);                        detailPic.append('<div class="form-group" name="detail_pic_group" id="' + imgId + '"><label class="col-sm-2 control-label"></label><div class="m-r col-sm-2">' +                        '<img src="' + arr[index] + '" name="ImgDetailPic" class="r r-2x" width="100%" height="100px" id="img' + imgId + '"  ></div><div class="m-r col-sm-3">' +                        '<br><button class="btn btn-danger" onclick="removePic(\'' + imgId + '\')"><i class="fa fa-trash-o"></i>&nbsp;&nbsp;&nbsp;<span>删除图片</span></button>');                    }                    val['contentFrom'];                });            },            error: function (message) {            }        });        }        //加载房屋基础设施        $("#btn_submit").click(function () {            /* var listPicId = $("input[name='ImgDetailPic']").filter(":checked").val();            console.log(listPicId); */            var imageDetailList = eval('[]');            $("img[name='ImgDetailPic']").each(function (index, element) {                imageDetailList.push($(this).attr('src'));            });            var data = {};            data.subject=$("#subject").val();        	data.displayLocation = $("[name='displayLocation']").filter(":checked").val();        	data.topicType = $("[name='topicType']").filter(":checked").val();        	data.contentFrom = $('#contentFrom').val();        	data.listpic=imageDetailList;        	        	var markupStr = $('#summernote').summernote('code');        	data.formatContent=markupStr;        	data.uid=uid;            if(tid!=null&&tid!=''&&tid!='undefined'){            	//更新            	data.tid=tid;            	$.ajax({                    type: "POST",                    async: true,                    url: "/api/topic/update",                    contentType: "application/json",                    data: JSON.stringify(data),                    dataType: "json",                    success: function (ret) {                        if (0 == ret['code']) {                            alert('操作成功!');                            window.location.href='/html/platform/activity.html';                        } else {                        	alert(ret['msg']);                        }                    },                    error: function (message) {                    }                });            }else{            	//添加            	$.ajax({                    type: "POST",                    async: true,                    url: "/api/topic/add",                    contentType: "application/json",                    data: JSON.stringify(data),                    dataType: "json",                    success: function (ret) {                        if (0 == ret['code']) {                        	alert('操作成功!');                        	window.location.href='/html/platform/activity.html';                        } else {                        	alert(ret['msg']);                        }                    },                    error: function (message) {                    }                });            }           /*  var op = GetQueryParam('op');            if ('op' == null) {                alert('操作未知！');                return;            }            if ('update' == op) {                $.ajax({                    type: "POST",                    async: true,                    url: "/api/product/update",                    contentType: "application/json",                    data: JSON.stringify(data),                    dataType: "json",                    success: function (ret) {                        if (0 == ret['code']) {                            alert("修改成功！");                        } else {                            alert(ret['msg']);                        }                    },                    error: function (message) {                        console.info(message);                    }                });            } else if ('add' == op) {                $.ajax({                    type: "POST",                    async: true,                    url: "/api/product/add",                    contentType: "application/json",                    data: JSON.stringify(data),                    dataType: "json",                    success: function (ret) {                        if (0 == ret['code']) {                            if ('update' != GetQueryParam('op')) {                                window.location.href = '/html/platform/productInfo.html?op=update&code=' + ret['result'];                            }                            alert("创建成功！");                        } else {                            alert(ret['msg']);                        }                    },                    error: function (message) {                        console.info(message);                    }                });            } else {                alert('操作未知！');                return;            } */        });    });    /* function refreshData() {        var code = GetQueryParam('code');        if (null == code) {            return;        }        var data = {};        data.productId = code;        $.ajax({            type: "POST",            async: true,            url: "/api/product/list",            contentType: "application/json",            data: JSON.stringify(data),            dataType: "json",            success: function (ret) {                if (0 == ret['code'] && ret['result'].length > 0) {                    fillData(ret['result'][0]);                }            },            error: function (message) {            }        });    } */    /* function fillData(data) {        $('#productId').val(data['productId']);        $('#supplierId').val(data['supplierId']);        getSupplierList(data['supplierId']);        $('#productName').val(data['productName']);        $('#productDetail').html(data['productDetail']);        $('#productDetailPicDiv').empty();        var areaCode = data['areaId'] + '';        $('#areaName').val(data['areaName']);        $('#areaId').html(data['areaId']);        $('#address').val(data['address']);        $('#position').val(data['position']);        $('#netRulesUrl').val(data['netRulesUrl']);        $('#productSort').val(data['productSort']);        $('#shopping').val(data['shopping']);        $('#transport').val(data['transport']);        $('#delicacy').val(data['delicacy']);        $('#entertainment').val(data['entertainment']);        var productActive = data['productActive'];        if (productActive) {            $('#product_active_label').html('<input type="checkbox" id="productActive" checked/> <span></span>');        } else {            $('#product_active_label').html('<input type="checkbox" id="productActive" /> <span></span>');        }        var listPic = data['listpic'];        var arr = data['detailpic'];        var detailPic = $('#productDetailPicDiv');        for (var index = 0; index < arr.length; index++) {            var imgId = getRandomId(10);            if ((null == listPic || undefined == listPic || '' == listPic) && index == 0) {                detailPic.append('<div class="form-group" name="detail_pic_group" id="' + imgId + '"><label class="col-sm-2 control-label"></label><div class="m-r col-sm-2">' +                    '<img src="' + arr[index] + '" name="ImgDetailPic" class="r r-2x" width="100%" height="100px"  id="img' + imgId + '"  ></div><div class="m-r col-sm-3">' +                    '<br></button><button class="btn btn-danger" onclick="removePic(\'' + imgId + '\')"><i class="fa fa-trash-o"></i>&nbsp;&nbsp;&nbsp;<span>删除图片</span></button>' +                    '<div class="radio i-checks"><label><input type="radio" name="detailpic" value="' + imgId + '"><i></i>设置为列表展示图</label></div></div></div>');            } else {                if (arr[index] == listPic) {                    detailPic.append('<div class="form-group" name="detail_pic_group" id="' + imgId + '"><label class="col-sm-2 control-label"></label><div class="m-r col-sm-2">' +                        '<img src="' + arr[index] + '" name="ImgDetailPic" class="r r-2x" width="100%" height="100px" id="img' + imgId + '"   ></div><div class="m-r col-sm-3">' +                        '<br><button class="btn btn-danger" onclick="removePic(\'' + imgId + '\')"><i class="fa fa-trash-o"></i>&nbsp;&nbsp;&nbsp;<span>删除图片</span></button>' +                        '<div class="radio i-checks"><label><input type="radio" name="detailpic" value="' + imgId + '" checked><i></i>设置为列表展示图</label></div></div></div>');                } else {                    detailPic.append('<div class="form-group" name="detail_pic_group" id="' + imgId + '"><label class="col-sm-2 control-label"></label><div class="m-r col-sm-2">' +                        '<img src="' + arr[index] + '" name="ImgDetailPic" class="r r-2x" width="100%" height="100px" id="img' + imgId + '"  ></div><div class="m-r col-sm-3">' +                        '<br><button class="btn btn-danger" onclick="removePic(\'' + imgId + '\')"><i class="fa fa-trash-o"></i>&nbsp;&nbsp;&nbsp;<span>删除图片</span></button>' +                        '<div class="radio i-checks"><label><input type="radio" name="detailpic" value="' + imgId + '"><i></i>设置为列表展示图</label></div></div></div>');                }            }        }        //填充个人福利        if (data['hasPersonal']) {            var personalWelfare = JSON.parse(data['personalWelfare']);            $("#remitPercent").val(personalWelfare['remitPercent']);            $("#payMentNum").val(personalWelfare['payMentNum']);            $("#mortagageNum").val(personalWelfare['mortagageNum']);            $("#welfareNotice").html(personalWelfare['notice']);            $("#welfareName").val(personalWelfare['name']);        }    } */    function removePic(index) {        $("#" + index).remove();    }    function GetQueryParam(name) {        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");        var r = window.location.search.substr(1).match(reg);        if (r != null) return unescape(r[2]);        return null;    }    function step1() {        $("#step1").css("display", "block");    }</script><!-- Bootstrap --><script src="/js/bootstrap.js"></script><!-- App --><script src="/js/app.js"></script><script src="/js/slimscroll/jquery.slimscroll.min.js"></script><script src="/js/app.plugin.js"></script></body></html>