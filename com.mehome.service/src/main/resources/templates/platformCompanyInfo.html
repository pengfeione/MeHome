<!DOCTYPE html><html lang="en" class="app" xmlns:th="http://www.thymeleaf.org"><head>    <meta charset="utf-8"/>    <title>ME+企业用户管理</title>    <meta name="description"          content="app, web app, responsive, admin dashboard, admin, flat, flat ui, ui kit, off screen nav"/>    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>    <link rel="stylesheet" href="/css/bootstrap.css" type="text/css"/>    <link rel="stylesheet" href="/css/animate.css" type="text/css"/>    <link rel="stylesheet" href="/css/font-awesome.min.css" type="text/css"/>    <link rel="stylesheet" href="/css/simple-line-icons.css" type="text/css"/>    <link rel="stylesheet" href="/css/font.css" type="text/css"/>    <link rel="stylesheet" href="/css/app.css" type="text/css"/>    <!--[if lt IE 9]>    <script src="js/ie/html5shiv.js"></script>    <script src="js/ie/respond.min.js"></script>    <script src="js/ie/excanvas.js"></script>    <![endif]--></head><body class=""><section class="vbox">    <header class="bg-white-only header header-md navbar navbar-fixed-top-xs">        <div class="navbar-header aside bg-info dk">            <a class="btn btn-link visible-xs" data-toggle="class:nav-off-screen,open" data-target="#nav,html">                <i class="icon-list"></i>            </a>            <a href="index.html" class="navbar-brand text-lt">                <i class="icon-earphones"></i>                <img src="/images/logo.png" alt="." class="hide"/>                <span class="hidden-nav-xs m-l-sm">ME+</span>            </a>            <a class="btn btn-link visible-xs" data-toggle="dropdown" data-target=".user">                <i class="icon-settings"></i>            </a>        </div>        <ul class="nav navbar-nav hidden-xs">            <li>                <a href="#nav,.navbar-header" data-toggle="class:nav-xs,nav-xs" class="text-muted">                    <i class="fa fa-indent text"></i>                    <i class="fa fa-dedent text-active"></i>                </a>            </li>        </ul>        <form class="navbar-form navbar-left input-s-lg m-t m-l-n-xs hidden-xs" role="search">            <div class="form-group">                <div class="input-group">            <span class="input-group-btn">              <button type="submit" class="btn btn-sm bg-white btn-icon rounded"><i class="fa fa-search"></i></button>            </span>                    <input type="text" class="form-control input-sm no-border rounded"                           placeholder="ME+搜索"/>                </div>            </div>        </form>        <div class="navbar-right ">            <ul class="nav navbar-nav m-n hidden-xs nav-user user">                <li class="hidden-xs">                    <a href="#" class="dropdown-toggle lt" data-toggle="dropdown">                        <i class="icon-bell"></i>                        <span class="badge badge-sm up bg-danger count">2</span>                    </a>                    <section class="dropdown-menu aside-xl animated fadeInUp">                        <section class="panel bg-white">                            <div class="panel-heading b-light bg-light">                                <strong>You have <span class="count">2</span> notifications</strong>                            </div>                            <div class="list-group list-group-alt">                                <a href="#" class="media list-group-item">                    <span class="pull-left thumb-sm">                      <img src="/images/a0.png" alt="..." class="img-circle"/>                    </span>                                    <span class="media-body block m-b-none">                      Use awesome animate.css<br/>                      <small class="text-muted">10 minutes ago</small>                    </span>                                </a>                                <a href="#" class="media list-group-item">                    <span class="media-body block m-b-none">                      1.0 initial released<br/>                      <small class="text-muted">1 hour ago</small>                    </span>                                </a>                            </div>                            <div class="panel-footer text-sm">                                <a href="#" class="pull-right"><i class="fa fa-cog"></i></a>                                <a href="#notes" data-toggle="class:show animated fadeInRight">See all the                                    notifications</a>                            </div>                        </section>                    </section>                </li>                <li class="dropdown">                    <a href="#" class="dropdown-toggle bg clear" data-toggle="dropdown">              <span class="thumb-sm avatar pull-right m-t-n-sm m-b-n-sm m-l-sm">                <img src="/images/a0.png" th:attr="src=${session.user.getAvatar()}" alt="..."/>              </span>                        <span th:text="${session.user.getNickName()}"></span><b class="caret"></b>                    </a>                    <ul class="dropdown-menu animated fadeInRight">                        <li>                            <span class="arrow top"></span>                            <a href="#">Settings</a>                        </li>                        <li>                            <a href="#">Profile</a>                        </li>                        <li>                            <a href="#">                                <span class="badge bg-danger pull-right">3</span>                                Notifications                            </a>                        </li>                        <li>                            <a href="">Help</a>                        </li>                        <li class="divider"></li>                        <li>                            <a href="/html/logout.html" data-toggle="ajaxModal">Logout</a>                        </li>                    </ul>                </li>            </ul>        </div>    </header>    <section>        <section class="hbox stretch">            <aside class="bg-black dk aside hidden-print" id="nav">                <section class="vbox">                    <section class="w-f-md scrollable">                        <div class="slim-scroll" data-height="auto" data-disable-fade-out="true" data-distance="0"                             data-size="10px" data-railOpacity="0.2">                            <!-- nav -->                            <nav class="nav-primary hidden-xs">                                <ul class="nav" data-ride="collapse">                                    <li>                                        <a href="#" class="auto"><span class="pull-right text-muted"><i                                                class="fa fa-angle-left text"></i><i                                                class="fa fa-angle-down text-active"></i></span><i                                                class="icon-grid icon"></i><span>平台后台1.0</span> </a>                                        <ul class="nav dk text-sm">                                            <li><a href="/html/platform/order.html" class="auto"><i                                                    class="fa fa-angle-right text-xs"></i><span>预约－租借管理</span></a></li>                                            <li><a href="/html/platform/product.html" class="auto"><i                                                    class="fa fa-angle-right text-xs"></i><span>产品资源管理</span></a></li>                                            <li><a href="/html/platform/users.html" class="auto"><i                                                    class="fa fa-angle-right text-xs"></i><span>用户资源管理</span></a></li>                                            <li><a href="/html/platform/companylist.html" class="auto"><i                                                    class="fa fa-angle-right text-xs"></i><span>合作企业</span></a></li>                                        </ul>                                    </li>                                </ul>                            </nav>                        </div>                    </section>                </section>            </aside>            <section id="content">                <section class="vbox">                    <section class="scrollable padder">                        <div class="m-b-md">                            <h3 class="m-b-none"></h3>                        </div>                        <section class="panel panel-default">                            <header class="panel-heading">                                <a href="#" class="btn btn-info"><i class="fa fa-plus"></i>&nbsp;&nbsp;&nbsp;企业信息</a>                            </header>                            <div class="row">                                <div class="col-sm-12">                                    <div class="panel panel-default col-sm-12">                                        <div class="panel-heading">                                            <ul class="nav nav-tabs font-bold">                                                <li class="active"><a id="tab_head_1"                                                                      data-toggle="tab">基本信息</a></li>                                                <li class=""><a id="tab_head_2" data-toggle="tab">企业福利</a>                                                </li>                                                <li class=""><a id="tab_head_3" data-toggle="tab">企业管理员</a>                                                </li>                                            </ul>                                        </div>                                        <div class="panel-body" id="step1">                                            <div class="form-horizontal" id="step1_form">                                                <input type="hidden" name="companyId"                                                       th:value="${companyInfo.companyId}" id="companyId">                                                <div class="form-group">                                                    <label class="col-sm-2 control-label">公司名称</label>                                                    <div class="col-sm-6">                                                        <input type="text" class="form-control" name="companyName"                                                               id="companyName"                                                               th:value="${companyInfo.companyName}"                                                               value="">                                                    </div>                                                </div>                                                <div class="line line-dashed b-b line-lg pull-in"></div>                                                <div class="form-group">                                                    <label class="col-sm-2 control-label" for="address">公司地址</label>                                                    <div class="col-sm-6">                                                        <input type="text" class="form-control"                                                               name="address" id="address"                                                               th:value="${companyInfo.address}">                                                    </div>                                                </div>                                                <div class="form-group form-inline">                                                    <label class="col-sm-2 control-label">企业授权码</label>                                                    <div class="col-sm-6">                                                        <input type="text" class="form-control" name="authCode"                                                               id="authCode"                                                               th:value="${companyInfo.authCode}"/>                                                        <button class="btn btn-info"                                                                id="build_auth_code" value="">自动生成                                                        </button>                                                    </div>                                                </div>                                                <div class="line line-dashed b-b line-lg pull-in"></div>                                                <div class="form-group">                                                    <label class="col-sm-2 control-label">公司企业编码</label>                                                    <div class="col-sm-6">                                                        <input type="text" name="companyCode" class="form-control"                                                               id="companyCode"                                                               th:value="${companyInfo.companyCode}">                                                    </div>                                                </div>                                                <div class="line line-dashed b-b line-lg pull-in"></div>                                                <div class="form-group">                                                    <label class="col-sm-2 control-label">企业法人</label>                                                    <div class="col-sm-6">                                                        <input type="text" class="form-control" id="artificialPerson"                                                               name="artificialPerson"                                                               th:value="${companyInfo.artificialPerson}" value=""/>                                                    </div>                                                </div>                                                <div class="line line-dashed b-b line-lg pull-in"></div>                                                <div class="form-group">                                                    <label class="col-sm-2 control-label">企业联系电话</label>                                                    <div class="col-sm-6">                                                        <input type="text" class="form-control" id="companyPhone"                                                               name="companyPhone"                                                               th:value="${companyInfo.companyPhone}"/>                                                    </div>                                                </div>                                                <div class="line line-dashed b-b line-lg pull-in"></div>                                                <div class="form-group">                                                    <label class="col-lg-2 control-label">企业法人身份证号</label>                                                    <div class="col-sm-6">                                                        <input class="form-control" type="text" id="identityCode"                                                               name="identityCode"                                                               th:value="${companyInfo.identityCode}">                                                    </div>                                                </div>                                                <div class="line line-dashed b-b line-lg pull-in"></div>                                                <div class="form-group">                                                    <label class="col-sm-2 control-label">公司激活状态</label>                                                    <div class="col-sm-6">                                                        <input class="btn btn-default btn-sm" id="companyActive"                                                               value="不激活" name="companyActive"                                                               th:value="${companyInfo.companyActive}?'激活':'不激活'"                                                               value="">                                                        </input>                                                    </div>                                                </div>                                                <div class="line line-dashed b-b line-lg pull-in"></div>                                                <div class="form-group">                                                    <label class="col-sm-2 control-label">企业logo</label>                                                    <div class="col-sm-4">                                                        <div class="bootstrap-filestyle" style="display: inline;"                                                             id="container">                                                            <a class="btn btn-default"                                                               id="selectfiles"><span>选择文件</span></a>                                                        </div>                                                        <div id="ossfile">                                                        </div>                                                    </div>                                                </div>                                                <div class="form-group">                                                    <label class="col-sm-2 control-label"></label>                                                    <div class="col-sm-4">                                                         <span class="thumb-lg avatar ">                                                            <img alt="..."                                                                 th:src="${companyInfo.logo}" name="logo"                                                                 id="logo"/>                                                        </span>                                                    </div>                                                </div>                                                <div class="line line-dashed b-b line-lg pull-in"></div>                                                <div class="form-group">                                                    <div class="col-sm-4 col-sm-offset-2">                                                        <button type="reset" class="btn btn-default">重置</button>                                                        <button type="button" class="btn btn-primary" id="btn_submit">                                                            保存                                                        </button>                                                    </div>                                                </div>                                            </div>                                        </div>                                        <div class="panel-body" id="step2">                                            <div class="line line-dashed b-b line-lg pull-in"></div>                                            <div id="company_welfare">                                            </div>                                            <div class="col-sm-12 visible-lg">                                                <a href="javascript:void(0)" onclick="addCompanyWelfareHtml()"                                                   class="btn btn-success col-sm-12">新增企业福利</a>                                            </div>                                            <br>                                            <br>                                            <div class="line line-dashed b-b line-lg pull-in"></div>                                        </div>                                        <div class="panel-body" id="step3">                                            <div class="form-horizontal">                                                <div class="line line-dashed b-b line-lg pull-in"></div>                                                <div class="form-group">                                                    <label class="col-sm-2 control-label">管理员账号</label>                                                    <div class="col-sm-2">                                                        <input type="text" class="form-control"                                                               name="name" id="admin_name"                                                               th:value="${admin}" src=""/>                                                    </div>                                                    <button class="btn btn-primary col-sm-1" onclick="saveAdmin()">                                                        保存                                                    </button>                                                </div>                                                <div class="line line-dashed b-b line-lg pull-in"></div>                                            </div>                                        </div>                                    </div>                                </div>                            </div>                            </div>                        </section>                        <div class="m-b-md">                            <div class="text-center padder clearfix">                                <p>                                    <small>上海寓伽信息科技有限公司&nbsp;&copy;2017</small>                                </p>                            </div>                        </div>                    </section>                </section>                <a href="#" class="hide nav-off-screen-block" data-toggle="class:nav-off-screen,open"                   data-target="#nav,html"></a>            </section>        </section>    </section></section><script src="/js/jquery.min.js"></script><script type="text/javascript"        src="http://resource.mjiahome.com/mj/static/oss_js/lib/plupload-2.1.2/js/plupload.full.min.js"></script><script src="http://resource.mjiahome.com/mj/static/oss_js/upload.js"></script><script type="application/javascript">    String.prototype.startWith = function (str) {        var reg = new RegExp("^" + str);        return reg.test(this);    };    $(function () {        step1();        $("#choose_file_label").bind("click", function () {            $("filestyle-0").trigger("click");        });        $("#tab_head_1").click(function () {            step1();        });        $("#tab_head_2").click(function () {            step2();        });        $("#tab_head_3").click(function () {            step3();        });        $("#companyActive").click(function () {            if ('激活' == $("#companyActive").val()) {                $("#companyActive").val('不激活');            } else {                $("#companyActive").val('激活');            }        });        $("#build_auth_code").click(function () {            var ab = random_string(6);            $("#authCode").val(ab)        });        $("#btn_submit").click(function () {            var data = {                "companyId": $("#companyId").val(),                "companyName": $("#companyName").val(),                "address": $("#address").val(),                "authCode": $("#authCode").val(),                "companyCode": $("#companyCode").val(),                "artificialPerson": $("#artificialPerson").val(),                "companyPhone": $("#companyPhone").val(),                "identityCode": $("#identityCode").val(),                "companyActive": $("#companyActive").val() == '激活' ? 1 : 0,                "logo": $("#logo")[0].src,            }            var op = GetQueryParam('op');            if ('op' == null) {                alert('操作未知！');                return;            }            if ('update' == op) {                $.ajax({                    type: "POST",                    async: true,                    url: "/api/company/update",                    contentType: "application/json",                    data: JSON.stringify(data),                    dataType: "json",                    success: function (ret) {                        if (0 == ret['code']) {                            alert("修改成功！");                        } else {                            alert(ret['msg']);                        }                    },                    error: function (message) {                        console.info(message);                    }                });            } else if ('add' == op) {                $.ajax({                    type: "POST",                    async: true,                    url: "/api/company/add",                    contentType: "application/json",                    data: JSON.stringify(data),                    dataType: "json",                    success: function (ret) {                        if (0 == ret['code']) {                            if ('update' != GetQueryParam('op')) {                                window.location.href = '/html/platform/companyinfo.html?op=update&code=' + ret['result'];                            }                            alert("创建成功！");                        } else {                            alert(ret['msg']);                        }                        console.info(ret);                    },                    error: function (message) {                        console.info(message);                    }                });            } else {                alert('操作未知！');                return;            }        });        refreshCompanyWelfare();    });    function refreshCompanyWelfare() {        var code = GetQueryParam('code');        if (null != code) {            var param = {'companyId': code};            $.ajax({                type: "POST",                async: true,                url: "/api/company/list_company_welfare",                contentType: "application/json",                data: JSON.stringify(param),                dataType: "json",                success: function (ret) {                    $("#company_welfare").empty();                    if (0 == ret['code']) {                        $.each(ret['result'], function (item, val) {                            buildCompanyWelfare(val);                        });                    }                },                error: function (message) {                }            });        }    }    function buildCompanyWelfare(val) {        var data = JSON.parse(val['welfareContent']);        var id = val['welfareId'] + '';        var welfareXml = '<div class="row" id="welfare' + val['welfareId'] + '">' +            '<div class="col-sm-5">' +            '<label class="col-sm-2 control-label">福利公告</label>' +            '<textarea class="form-control parsley-validated" rows="6" data-minwords="6" name="notice">' + data['notice'] + '</textarea></div>' +            '<div class="col-sm-6 form-horizontal"><label class="col-sm-2 control-label"></label>' +            '<br><div class="form-group"><label class="col-sm-2 control-label">房租减免</label>' +            '<div class="col-sm-10"><div class="input-group m-b col-sm-2">' +            '<input type="text" class="form-control" name="remitPercent" value="' + data['remitPercent'] + '"><span class="input-group-addon">%</span></div></div></div><div class="form-group form-inline">' +            '<label class="col-sm-2 control-label">支付模式</label><div class="col-sm-10"><div class="input-group m-b col-sm-3">' +            '<span class="input-group-addon">压</span>' +            '<input type="text" class="form-control" name="mortagageNum" value="' + data['mortagageNum'] + '">' +            '<span class="input-group-addon">月</span></div>' +            '<div class="input-group m-b col-sm-3"><span class="input-group-addon">付</span>' +            '<input type="text" class="form-control" name="payMentNum" value="' + data['payMentNum'] + '">' +            '<span class="input-group-addon">月</span></div></div></div><div class="form-group"><div class="col-sm-4 col-sm-offset-2">';        if (!id.startWith('s')) {            welfareXml += '<button class="btn btn-danger btn-s-md btn-rounded" onclick="deleteCompanyWelfare(' + +val['welfareId'] + ')">删除</button>' +                '<button class="btn btn-primary btn-s-md btn-rounded" onclick="updateCompanyWelfare(' + +val['welfareId'] + ')">保存</button></div></div></div></div><div class="line line-dashed b-b line-lg pull-in"></div>';        } else {            welfareXml += '<button class="btn btn-danger btn-s-md btn-rounded" onclick="deleteCompanyWelfare(\'' + id + '\')">删除</button>' +                '<button class="btn btn-primary btn-s-md btn-rounded" onclick="addCompanyWelfare(\'' + id + '\')">保存</button></div></div></div></div><div class="line line-dashed b-b line-lg pull-in"></div>';        }        $("#company_welfare").append(welfareXml);    }    function saveAdmin() {        var code = GetQueryParam('code');        if (null == code) {            alert("请先保存公司的基本信息");            return;        }        var adminName = $("#admin_name").val();        var code = GetQueryParam('code');        if (adminName.length > 0 && undefined != code && code.length > 0) {            $.ajax({                type: "POST",                async: true,                url: "/api/company/update_company_admin",                contentType: "application/json",                data: JSON.stringify({'name': adminName, 'companyId': code}),                dataType: "json",                success: function (ret) {                    if (0 == ret['code']) {                        alert("修改成功");                    } else {                        alert(ret['msg']);                    }                },                error: function (message) {                }            });        } else {            alert("管理账号不能为空！");        }    }    function deleteCompanyWelfare(welfareId) {        var id = welfareId + '';        if (id.startWith('s')) {            refreshCompanyWelfare();        } else {            var data = {};            data.welfareId = welfareId;            data.welfareActive = false;            $.ajax({                type: "POST",                async: true,                url: "/api/company/update_company_welfare",                contentType: "application/json",                data: JSON.stringify(data),                dataType: "json",                success: function (ret) {                    if (0 == ret['code']) {                        refreshCompanyWelfare();                        alert("删除成功！");                    } else {                        alert(ret['msg']);                    }                },                error: function (message) {                }            });        }    }    function updateCompanyWelfare(welfareId) {        var notice = {};        $('#welfare' + welfareId + ' input').each(function (item, val) {            notice[$(this).attr("name")] = $(this).val()        });        $('#welfare' + welfareId + ' textarea').each(function (item, val) {            notice[$(this).attr("name")] = $(this).val()        });        if (notice.remitPercent > 100 || notice.remitPercent < 0) {            alert("折扣比例的范围（0~100）");            return;        }        if (notice.payMentNum < 0) {            alert("首次支付的月数不能小于0");            return;        }        if (notice.mortagageNum < 0) {            alert("首次支付的押金月数不能小于0");            return;        }        var data = {};        data.welfareId = welfareId;        data.welfareContent = JSON.stringify(notice);        data.companyId = GetQueryParam('code');        $.ajax({            type: "POST",            async: true,            url: "/api/company/update_company_welfare",            contentType: "application/json",            data: JSON.stringify(data),            dataType: "json",            success: function (ret) {                if (0 == ret['code']) {                    refreshCompanyWelfare();                    alert("修改成功！");                } else {                    alert(ret['msg']);                }            },            error: function (message) {            }        });    }    function addCompanyWelfareHtml() {        var code = GetQueryParam('code');        if (null == code) {            alert("请先保存公司的基本信息");            return;        }        var data = {};        var notice = {            'notice': '',            'remitPercent': 0,            'mortagageNum': 0,            'payMentNum': 0        };        data.welfareId = 's' + random_string(5);        data.welfareContent = JSON.stringify(notice);        data.companyId = GetQueryParam('code');        buildCompanyWelfare(data);    }    function addCompanyWelfare(welfareId) {        var notice = {};        $('#welfare' + welfareId + ' input').each(function (item, val) {            notice[$(this).attr("name")] = $(this).val()        });        $('#welfare' + welfareId + ' textarea').each(function (item, val) {            notice[$(this).attr("name")] = $(this).val()        });        var data = {};        data.welfareContent = JSON.stringify(notice);        data.companyId = GetQueryParam('code');        $.ajax({            type: "POST",            async: true,            url: "/api/company/add_company_welfare",            contentType: "application/json",            data: JSON.stringify(data),            dataType: "json",            success: function (ret) {                if (0 == ret['code']) {                    refreshCompanyWelfare();                    alert("添加成功！");                } else {                    alert(ret['msg']);                }            },            error: function (message) {            }        });    }    function GetQueryParam(name) {        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");        var r = window.location.search.substr(1).match(reg);        if (r != null)return unescape(r[2]);        return null;    }    function step1() {        $("#step1").css("display", "block");        $("#step2").css("display", "none");        $("#step3").css("display", "none");    }    function step2() {        $("#step1").css("display", "none");        $("#step2").css("display", "block");        $("#step3").css("display", "none");    }    function step3() {        $("#step1").css("display", "none");        $("#step2").css("display", "none");        $("#step3").css("display", "block");    }</script><!-- Bootstrap --><script src="/js/bootstrap.js"></script><!-- App --><script src="/js/app.js"></script><script src="/js/slimscroll/jquery.slimscroll.min.js"></script><script src="/js/app.plugin.js"></script></body></html>