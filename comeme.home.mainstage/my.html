<!DOCTYPE HTML>
<html lang="zh-cn">
<head>
<!--<base href="http://127.0.0.1:8020/comeme.home.mainstage/"/>-->
<base href="http://m.mjiahome.com/"/>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name = "format-detection" content="telephone=no">
<meta name="viewport"  content="width=device-width,user-scalable=no">
<title>Me+我的</title>
<meta name="keywords" content="ME+">
<meta name="description" content="ME+">
<link rel="stylesheet" type="text/css" href="css/base.css" />
<link rel="stylesheet" type="text/css" href="css/common.css" />
<link rel="stylesheet" type="text/css" href="css/index.css" />
<script src="js/jquery.min.js"></script>
<script src="js/util.js"></script>
</head>
<body>
    
    <div class="wrap">
    	<!-- header -->
    	<header class="bannerMy">
            <img src="img/bannerMy.jpg" />
            <span class="myHeader"><img src="img/test/test4.jpg" id="img_avatar"/></span>
            <span class="myName" id="span_name">雍容风雅</span>
            <span class="myClass" id="span_company" style="display: none;"></span>
        </header>
        
        <section class="section">
        	<div class="myList">
            	<ul>
                	<li><a onclick="myOrder();"><em class="iconMy"></em>我的订单<i class="iconMore"></i></a></li>
                    <li><a onclick="editUserInfo();"><em class="iconEdit"></em>编辑个人信息<i class="iconMore"></i></a></li>
                </ul>
            </div>
        </section>
        
        <!-- footer -->
        <footer class="footer">
        	<a href="index.html">发现</a>
            <a href="my.html" class="curr">我的</a>
        </footer>
        
    </div>
    
</body>
<script type="text/javascript">
	var util;
	var isSubmit = 0;
	//页面初始化
	$(function(){
		util = new Util();
		flushUerInfo();
		loadUserInfo();
	});
	
	//刷新个人信息
	function flushUerInfo(){
		var userInfo = util.getCookie("userInfo");
		if(userInfo != null && userInfo != ''){
			var userInfoJson = eval('(' + userInfo + ')');
			util.logResult(userInfoJson.userId);
			var userId = userInfoJson.userId;
			var url = util.baseUrl + '/usr/get'; 
			var param ='{"userId": '+userId+'}';
			var contentType = "application/json";
			util.requestRemoteDataJsonPosta(url,param,contentType,function(data){
				var result = data.result;
				if(result == null || result == undefined){
					window.location.href='login.html';
				}
				util.logResult(result); 
				var companyStatus = result.companyStatus;
				userInfoJson.companyStatus = companyStatus;
				util.setCookie("userInfo", JSON.stringify(userInfoJson));
			});
		}
	}
	
	//加载个人信息
	function loadUserInfo(){
		var userInfo = util.getCookie("userInfo");
		var userInfoJson = eval('(' + userInfo + ')');
		util.logResult(userInfoJson); 
		var avatar = userInfoJson.avatar;
		var nickName = userInfoJson.nickName;
		var companyStatus = userInfoJson.companyStatus;
		$("#img_avatar").attr('src',avatar);
		$('#span_name').html(nickName);
		if(companyStatus == 1){
			$('#span_company').show();
		}
	}
	
	//我的订单
	function myOrder(){
		window.location.href='order.html';
	}
	
	//编辑个人信息
	function editUserInfo(){
		window.location.href='editinfo.html';
	}
	
</script>
</html>